(function(e){if(typeof exports==="object"&&typeof module!=="undefined"){module.exports=e()}else if(typeof define==="function"&&define.amd){define([],e)}else{var t;if(typeof window!=="undefined"){t=window}else if(typeof global!=="undefined"){t=global}else if(typeof self!=="undefined"){t=self}else{t=this}t.Ciseaux=e()}})(function(){var e,t,n;return function r(e,t,n){function a(u,s){if(!t[u]){if(!e[u]){var o=typeof require=="function"&&require;if(!s&&o)return o(u,!0);if(i)return i(u,!0);var f=new Error("Cannot find module '"+u+"'");throw f.code="MODULE_NOT_FOUND",f}var c=t[u]={exports:{}};e[u][0].call(c.exports,function(t){var n=e[u][1][t];return a(n?n:t)},c,c.exports,r,e,t,n)}return t[u].exports}var i=typeof require=="function"&&require;for(var u=0;u<n.length;u++)a(n[u]);return a}({1:[function(e,t,n){"use strict";t.exports={sampleRate:0}},{}],2:[function(e,t,n){"use strict";var r=function(e,t,n){if(t)Object.defineProperties(e,t);if(n)Object.defineProperties(e.prototype,n)};var a=function(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}};var i=function(){function e(t,n,r){a(this,e);this.data=t;this.beginTime=n;this.endTime=r;this.gain=1;this.pan=0;this.reverse=false;this.pitch=1;this.stretch=false}r(e,null,{duration:{get:function(){return(this.endTime-this.beginTime)/this.pitch},configurable:true},slice:{value:function t(e,n){e=this.beginTime+e*this.pitch;var r=e+n*this.pitch;e=Math.max(this.beginTime,e);r=Math.max(e,Math.min(r,this.endTime));return this.clone({beginTime:e,endTime:r})},writable:true,configurable:true},clone:{value:function n(t){var n=new e(this.data,this.beginTime,this.endTime);n.gain=this.gain;n.pan=this.pan;n.reverse=this.reverse;n.pitch=this.pitch;n.stretch=this.stretch;if(t){Object.keys(t).forEach(function(e){n[e]=t[e]})}return n},writable:true,configurable:true},toJSON:{value:function i(){return{data:this.data,beginTime:this.beginTime,endTime:this.endTime,gain:this.gain,pan:this.pan,reverse:this.reverse,pitch:this.pitch,stretch:this.stretch}},writable:true,configurable:true}});return e}();t.exports=i},{}],3:[function(e,t,n){(function(e){"use strict";var n=function(e,t,n){if(t)Object.defineProperties(e,t);if(n)Object.defineProperties(e.prototype,n)};var r=function(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}};var a=!!(e===e.window&&e.URL&&e.Blob&&e.Worker);var i=function(){function t(n,self){var i=this;r(this,t);if(a){var u=n.toString().trim().match(/^function\s*\w*\s*\([\w\s,]*\)\s*{([\w\W]*?)}$/)[1];var s=e.URL.createObjectURL(new e.Blob([u],{type:"text/javascript"}));return new e.Worker(s)}this.self=self;this.self.postMessage=function(e){setTimeout(function(){i.onmessage({data:e})},0)};setTimeout(function(){n.call(self)},0)}n(t,null,{postMessage:{value:function i(e){var t=this;setTimeout(function(){t.self.onmessage({data:e})},0)},writable:true,configurable:true}});return t}();t.exports=i}).call(this,typeof global!=="undefined"?global:typeof self!=="undefined"?self:typeof window!=="undefined"?window:{})},{}],4:[function(e,t,n){"use strict";var r=function(e){return e&&e.__esModule?e["default"]:e};var a=r(e("./inline-worker"));var self={};var i=new a(function(){self.repository={};self.onmessage=function(e){switch(e.data.type){case"transfer":self.repository[e.data.data]=e.data.buffers.map(function(e){return new Float32Array(e)});break;case"dispose":e.data.ids.forEach(function(e){delete self.repository[e]});break;case"render":self.start_rendering(e.data.tape,e.data.callbackId);break}};self.to_buffer=function(e){return e.buffer};self.start_rendering=function(e,t){var n=self.alloc_data(e);var r=n.map(self.to_buffer);self.render(e,n);self.postMessage({callbackId:t,buffers:r},r)};self.alloc_data=function(e){var t=new Array(e.numberOfChannels);var n=Math.floor(e.duration*e.sampleRate);for(var r=0;r<t.length;r++){t[r]=new Float32Array(n)}return t};self.render=function(e,t){for(var n=0;n<e.tracks.length;n++){self._render(e.tracks[n],t,e.sampleRate)}};self._render=function(e,t,n){var r=e.reduce(function(e,t){return Math.max(e,t.pan)},0);var a=0;for(var i=0,u=e.length;i<u;i++){var s=e[i];var o=self.repository[s.data];var f=(s.endTime-s.beginTime)/s.pitch;var c=Math.floor(f*n);if(!o){a+=c;continue}var l=Math.floor(s.beginTime*n);var h=Math.floor(s.endTime*n);var m=o.length;var p=t.length;var v=self.subarray(o,l,h);var d=self.subarray(t,a,a+c);var g=s.pitch;var b=i===0&&g===1&&r===0&&s.gain===1&&!s.reverse&&m<=p;if(b){self.mix[""+v.length+"->"+d.length](v,d)}else{self.process(v,d,{gain:s.gain,pan:r!==0?Math.max(-1,Math.min(s.pan,+1)):null,reverse:!!s.reverse})}a+=c}};self.subarray=function(e,t,n){var r=new Array(e.length);for(var a=0;a<r.length;a++){r[a]=e[a].subarray(t,n)}return r};self.process=function(e,t,n){var r=new Array(e.length);var a=e.length;var i=t.length;var u;var s=e[0].length;var o=t[0].length;var f=(s-1)/(o-1);var c,l,h,m,p,v;if(n.pan!==null){p=Math.cos((n.pan+1)*.25*Math.PI);v=Math.sin((n.pan+1)*.25*Math.PI);u=Math.max(a,2)}else{u=a}m=self.mix1[""+u+"->"+i]||self.mix1.nop;if(n.reverse){c=t[0].length-1;l=-1}else{c=0;l=+1}for(var d=0;d<o;d++,c+=l){var g=d*f;var b=g|0;var w=Math.min(b+1,s-1);for(h=0;h<a;h++){r[h]=e[h][b]+Math.abs(g-b)*(e[h][w]-e[h][b])}if(n.pan!==null){r=self.pan[a](r,p,v)}var y=m(r);for(h=0;h<i;h++){t[h][c]+=(y[h]||0)*n.gain}}};self.pan=[];self.pan[1]=function(e,t,n){return[e[0]*t,e[0]*n]};self.pan[2]=function(e,t,n){var r=(e[0]+e[1])*.5;return[r*t,r*n]};self.pan[4]=function(e,t,n){var r=(e[0]+e[1])*.5;var a=(e[2]+e[3])*.5;return[r*t,r*n,a*t,a*n]};self.pan[6]=function(e,t,n){var r=(e[0]+e[1])*.5;var a=(e[4]+e[5])*.5;return[r*t,r*n,e[2],e[3],a*t,a*n]};self.mix={};self.mix["1->1"]=function(e,t){t[0].set(e[0])};self.mix["1->2"]=function(e,t){t[0].set(e[0]);t[1].set(e[0])};self.mix["1->4"]=function(e,t){t[0].set(e[0]);t[1].set(e[0])};self.mix["1->6"]=function(e,t){t[2].set(e[0])};self.mix["2->2"]=function(e,t){t[0].set(e[0]);t[1].set(e[1])};self.mix["2->4"]=function(e,t){t[0].set(e[0]);t[1].set(e[1])};self.mix["2->6"]=function(e,t){t[0].set(e[0]);t[1].set(e[1])};self.mix["4->4"]=function(e,t){t[0].set(e[0]);t[1].set(e[1]);t[2].set(e[2]);t[3].set(e[3])};self.mix["4->6"]=function(e,t){t[0].set(e[0]);t[1].set(e[1]);t[4].set(e[2]);t[5].set(e[3])};self.mix["6->6"]=function(e,t){t[0].set(e[0]);t[1].set(e[1]);t[2].set(e[2]);t[3].set(e[3]);t[4].set(e[4]);t[5].set(e[5])};self.mix1={};self.mix1.nop=function(e){return e};self.mix1["1->2"]=function(e){return[e[0],e[0]]};self.mix1["1->4"]=function(e){return[e[0],e[0],0,0]};self.mix1["1->6"]=function(e){return[0,0,e[0],0,0,0]};self.mix1["2->4"]=function(e){return[e[0],e[1],0,0]};self.mix1["2->6"]=function(e){return[e[0],e[1],0,0,0,0]};self.mix1["4->6"]=function(e){return[e[0],e[1],0,0,e[2],e[3]]};self.mix1["2->1"]=function(e){return[.5*(e[0]+e[1])]};self.mix1["4->1"]=function(e){return[.25*(e[0]+e[1]+e[2]+e[3])]};self.mix1["6->1"]=function(e){return[.7071*(e[0]+e[1])+e[2]+.5*(e[4]+e[5])]};self.mix1["4->2"]=function(e){return[.5*(e[0]+e[2]),.5*(e[1]+e[3])]};self.mix1["6->2"]=function(e){return[e[0]+.7071*(e[2]+e[4]),e[1]+.7071*(e[2]+e[5])]};self.mix1["6->4"]=function(e){return[e[0]+.7071*e[2],e[1]+.7071*e[2],e[4],e[5]]}},self);var u=[];var s=1;i.onmessage=function(e){var t=e.data.buffers.map(function(e){return new Float32Array(e)});u[e.data.callbackId](t);u[e.data.callbackId]=null};t.exports={transfer:function(e){var t=s++;var n=e.map(function(e){return e.buffer});i.postMessage({type:"transfer",data:t,buffers:n},n);return t},dispose:function(e){i.postMessage({type:"dispose",ids:e})},render:function(e){var t=u.length;i.postMessage({type:"render",tape:e,callbackId:t});return new Promise(function(e){u[t]=e})},util:self}},{"./inline-worker":3}],5:[function(e,t,n){"use strict";var r=function(e){return e&&e.__esModule?e["default"]:e};var a=function(e,t,n){if(t)Object.defineProperties(e,t);if(n)Object.defineProperties(e.prototype,n)};var i=function(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}};var u=r(e("./tape"));var s=r(e("./config"));var o=function(e,t,n){if(!e.hasOwnProperty(t)){return null}var r=e[t];if(typeof r==="function"){r=r(t,n)}return r instanceof u?r:null};var f=function(){function e(t,n){i(this,e);this.pattern=t;this.durationPerStep=n}a(e,null,{apply:{value:function t(e){var t=String(this.pattern);var n=Math.max(0,+this.durationPerStep||0);if(!(t.length&&n&&e&&typeof e==="object")){return u.silence(0)}return t.split("").reduce(function(t,r){var a=o(e,r,t);if(a!==null){if(a.duration<n){t=t.concat(a,u.silence(n-a.duration))}else{t=t.concat(a.slice(0,n))}}else{t=t.concat(u.silence(n))}return t},new u(1,s.sampleRate))},writable:true,configurable:true}});return e}();t.exports=f},{"./config":1,"./tape":6}],6:[function(e,t,n){"use strict";var r=function(e){return e&&e.__esModule?e["default"]:e};var a=function(e,t,n){if(t)Object.defineProperties(e,t);if(n)Object.defineProperties(e.prototype,n)};var i=function(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}};var u=r(e("./track"));var s=r(e("./config"));var o={};var f=function(){function e(t,n){i(this,e);this.tracks=[new u];this._numberOfChannels=Math.max(1,t|0);this._sampleRate=Math.max(0,n|0)||s.sampleRate}a(e,{silence:{value:function t(n){return new e(1,s.sampleRate).silence(n)},writable:true,configurable:true},concat:{value:function n(t){return new e(1,s.sampleRate).concat(t)},writable:true,configurable:true},mix:{value:function r(t,n){var r=new e(1,s.sampleRate);if(Array.isArray(t)){t.forEach(function(e){r=r.mix(e,n)});if(1<r.tracks.length){r.tracks.shift()}}return r},writable:true,configurable:true}},{sampleRate:{get:function(){return this._sampleRate||s.sampleRate},configurable:true},length:{get:function(){return Math.floor(this.duration*this.sampleRate)},configurable:true},duration:{get:function(){return this.tracks[0].duration},configurable:true},numberOfChannels:{get:function(){return this._numberOfChannels},configurable:true},numberOfTracks:{get:function(){return this.tracks.length},configurable:true},gain:{value:function(e){var t=function n(){return e.apply(this,arguments)};t.toString=function(){return e.toString()};return t}(function(){var t=arguments[0]===undefined?1:arguments[0];t=o.toNumber(t);var n=new e(this.numberOfChannels,this.sampleRate);n.tracks=this.tracks.map(function(e){return e.gain(t)});return n}),writable:true,configurable:true},pan:{value:function(e){var t=function n(){return e.apply(this,arguments)};t.toString=function(){return e.toString()};return t}(function(){var t=arguments[0]===undefined?0:arguments[0];t=o.toNumber(t);var n=new e(this.numberOfChannels,this.sampleRate);n.tracks=this.tracks.map(function(e){return e.pan(t)});return n}),writable:true,configurable:true},reverse:{value:function f(){var t=new e(this.numberOfChannels,this.sampleRate);t.tracks=this.tracks.map(function(e){return e.reverse()});return t},writable:true,configurable:true},pitch:{value:function c(){var t=arguments[0]===undefined?1:arguments[0];t=Math.max(0,o.toNumber(t));var n=new e(this.numberOfChannels,this.sampleRate);n.tracks=this.tracks.map(function(e){return e.pitch(t)});return n},writable:true,configurable:true},stretch:{value:function l(){var t=arguments[0]===undefined?1:arguments[0];t=Math.max(0,o.toNumber(t));var n=new e(this.numberOfChannels,this.sampleRate);n.tracks=this.tracks.map(function(e){return e.stretch(t)});return n},writable:true,configurable:true},clone:{value:function h(){var t=new e(this.numberOfChannels,this.sampleRate);t.tracks=this.tracks.map(function(e){return e.clone()});return t},writable:true,configurable:true},silence:{value:function m(){var t=arguments[0]===undefined?0:arguments[0];t=Math.max(0,o.toNumber(t));var n=new e(this.numberOfChannels,this.sampleRate);if(0<t){n.tracks=this.tracks.map(function(){return u.silence(t)})}return n},writable:true,configurable:true},concat:{value:function p(){for(var t=arguments.length,n=Array(t),r=0;r<t;r++){n[r]=arguments[r]}var a=new e(this.numberOfChannels,this.sampleRate);a.tracks=this.tracks.map(function(e){return e.clone()});Array.prototype.concat.apply([],n).forEach(function(t){if(!(t instanceof e&&0<t.duration)){return}if(a._numberOfChannels<t._numberOfChannels){a._numberOfChannels=t._numberOfChannels}if(a.numberOfTracks<t.numberOfTracks){a=o.adjustNumberOfTracks(a,t.numberOfTracks)}if(t.numberOfTracks<a.numberOfTracks){t=o.adjustNumberOfTracks(t,a.numberOfTracks)}t.tracks.forEach(function(e,t){a.tracks[t].append(e)})});return a},writable:true,configurable:true},slice:{value:function v(){var t=arguments[0]===undefined?0:arguments[0];var n=arguments[1]===undefined?Infinity:arguments[1];t=o.toNumber(t);n=Math.max(0,o.toNumber(n));if(t<0){t+=this.duration}t=Math.max(0,t);var r=new e(this.numberOfChannels,this.sampleRate);r.tracks=this.tracks.map(function(e){return e.slice(t,n)});return r},writable:true,configurable:true},loop:{value:function d(){var t=arguments[0]===undefined?2:arguments[0];t=Math.max(0,t|0);var n=new Array(t);for(var r=0;r<n.length;r++){n[r]=this}return new e(this.numberOfChannels,this.sampleRate).concat(n)},writable:true,configurable:true},fill:{value:function g(){var e=arguments[0]===undefined?this.duration:arguments[0];e=Math.max(0,o.toNumber(e));var t=this.duration;var n=Math.floor(e/t);var r=e%t;return this.loop(n).concat(this.slice(0,r))},writable:true,configurable:true},replace:{value:function b(){var e=arguments[0]===undefined?0:arguments[0];var t=arguments[1]===undefined?0:arguments[1];var n=arguments[2]===undefined?null:arguments[2];e=o.toNumber(e);t=Math.max(0,o.toNumber(t));if(e<0){e+=this.duration}e=Math.max(0,e);return this.slice(0,e).concat(n,this.slice(e+t))},writable:true,configurable:true},split:{value:function w(){var e=arguments[0]===undefined?2:arguments[0];e=Math.max(0,e|0);var t=new Array(e);var n=this.duration/e;for(var r=0;r<e;r++){t[r]=this.slice(n*r,n)}return t},writable:true,configurable:true},mix:{value:function y(t,n){var r=new e(this.numberOfChannels,this.sampleRate);r.tracks=this.tracks.map(function(e){return e.clone()});if(t instanceof e){if(r._numberOfChannels<t._numberOfChannels){r._numberOfChannels=t._numberOfChannels}if(r.duration<t.duration){r=o.adjustDuration(r,t.duration,n)}if(t.duration<r.duration){t=o.adjustDuration(t,r.duration,n)}r.tracks=r.tracks.concat(t.tracks)}return r},writable:true,configurable:true},render:{value:function O(){return new Promise(function(e,t){t(new Error("not implemented"))})},writable:true,configurable:true},dispose:{value:function x(){},writable:true,configurable:true},toJSON:{value:function k(){return{tracks:this.tracks.map(function(e){return e.toJSON()}),duration:this.duration,sampleRate:this.sampleRate,numberOfChannels:this.numberOfChannels}},writable:true,configurable:true}});return e}();o.toNumber=function(e){return+e||0};o.adjustNumberOfTracks=function(e,t){var n=new f(e.numberOfChannels,e.sampleRate);n.tracks=e.tracks.map(function(e){return e.clone()});var r=t-n.numberOfTracks;var a=n.duration;for(var i=0;i<r;i++){n.tracks.push(u.silence(a))}return n};o.adjustDuration=function(e,t,n){switch(n){case"fill":return e.fill(t);case"pitch":return e.pitch(e.duration/t);case"stretch":return e.stretch(e.duration/t);default:return e.concat(e.silence(t-e.duration))}};t.exports=f},{"./config":1,"./track":7}],7:[function(e,t,n){"use strict";var r=function(e){return e&&e.__esModule?e["default"]:e};var a=function(e,t,n){if(t)Object.defineProperties(e,t);if(n)Object.defineProperties(e.prototype,n)};var i=function(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}};var u=r(e("./fragment"));var s=function(){function e(){var t=arguments[0]===undefined?[]:arguments[0];var n=arguments[1]===undefined?0:arguments[1];i(this,e);this.fragments=t;if(t.length!==0&&n===0){n=t.reduce(function(e,t){return e+t.duration},0)}this.duration=n}a(e,{silence:{value:function t(n){return new e([new u(0,0,n)],n)},writable:true,configurable:true}},{gain:{value:function(e){var t=function n(){return e.apply(this,arguments)};t.toString=function(){return e.toString()};return t}(function(t){return new e(this.fragments.map(function(e){return e.clone({gain:e.gain*t})}),this.duration)}),writable:true,configurable:true},pan:{value:function(e){var t=function n(){return e.apply(this,arguments)};t.toString=function(){return e.toString()};return t}(function(t){return new e(this.fragments.map(function(e){return e.clone({pan:e.pan+t})}),this.duration)}),writable:true,configurable:true},reverse:{value:function n(){return new e(this.fragments.map(function(e){return e.clone({reverse:!e.reverse})}).reverse(),this.duration)},writable:true,configurable:true},pitch:{value:function r(t){return new e(this.fragments.map(function(e){return e.clone({pitch:e.pitch*t,stretch:false})}),0)},writable:true,configurable:true},stretch:{value:function s(t){return new e(this.fragments.map(function(e){return e.clone({pitch:e.pitch*t,stretch:true})}),0)},writable:true,configurable:true},clone:{value:function o(){return new e(this.fragments.slice(),this.duration)},writable:true,configurable:true},slice:{value:function f(t,n){var r=new e;var a=Math.max(0,t);var i=n;for(var u=0;0<i&&u<this.fragments.length;u++){if(this.fragments[u].duration<=a){a-=this.fragments[u].duration}else{var s=this.fragments[u].slice(a,i);r.addFragment(s);a=0;i-=s.duration}}return r},writable:true,configurable:true},toJSON:{value:function c(){return this.fragments.map(function(e){return e.toJSON()})},writable:true,configurable:true},addFragment:{value:function l(e){if(e instanceof u&&0<e.duration){this.fragments.push(e);this.duration+=e.duration}return this},writable:true,configurable:true},append:{value:function h(t){var n=this;if(t instanceof e){t.fragments.forEach(function(e){n.addFragment(e)})}return this},writable:true,configurable:true}});return e}();t.exports=s},{"./fragment":2}],8:[function(e,t,n){"use strict";var r=function(e){return e&&e.__esModule?e["default"]:e};var a=function(e,t,n){if(t)Object.defineProperties(e,t);if(n)Object.defineProperties(e.prototype,n)};var i=function m(e,t,n){var r=Object.getOwnPropertyDescriptor(e,t);if(r===undefined){var a=Object.getPrototypeOf(e);if(a===null){return undefined}else{return m(a,t,n)}}else if("value"in r&&r.writable){return r.value}else{var i=r.get;if(i===undefined){return undefined}return i.call(n)}};var u=function(e,t){if(typeof t!=="function"&&t!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof t)}e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:false,writable:true,configurable:true}});if(t)e.__proto__=t};var s=function(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}};var o=r(e("./tape"));var f=r(e("./fragment"));var c=r(e("./config"));var l=r(e("./renderer"));var h=function(e){function t(e){s(this,t);i(Object.getPrototypeOf(t.prototype),"constructor",this).call(this,e.numberOfChannels,e.sampleRate);var n=new Array(e.numberOfChannels);for(var r=0;r<n.length;r++){n[r]=e.getChannelData(r)}this._data=l.transfer(n);this.tracks[0].addFragment(new f(this._data,0,e.duration));c.sampleRate=e.sampleRate}u(t,e);a(t,null,{render:{value:function n(e){var t=arguments[1]===undefined?this.numberOfChannels:arguments[1];var n=this.toJSON();n.numberOfChannels=t;return l.render(n).then(function(r){var a=Math.floor(n.duration*n.sampleRate);var i=e.createBuffer(t,a,n.sampleRate);if(i.copyToChannel){for(var u=0;u<t;u++){i.copyToChannel(r[u],u)}}else{for(var u=0;u<t;u++){i.getChannelData(u).set(r[u])}}return i})},writable:true,configurable:true},dispose:{value:function r(){l.dispose([this._data])},writable:true,configurable:true}});return t}(o);t.exports=h},{"./config":1,"./fragment":2,"./renderer":4,"./tape":6}],9:[function(e,t,n){"use strict";var r=function(e){return e&&e.__esModule?e["default"]:e};var a=r(e("./sequence"));var i=r(e("./web-audio-tape"));var u=i.silence;var s=i.concat;var o=i.mix;t.exports={Sequence:a,Tape:i,silence:u,concat:s,mix:o}},{"./sequence":5,"./web-audio-tape":8}]},{},[9])(9)});